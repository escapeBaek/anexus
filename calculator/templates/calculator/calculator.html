{% extends 'base.html' %} {% block page_content %} {% load static %}
<link rel="stylesheet" href="{% static 'calculator/css/calculator.css' %}" />
<!--<script src="{% static 'ped/js/pedcalc.js' %}" defer></script>-->

<div class="calculator-hero">
  <div class="hero-overlay"></div>
  <div class="container position-relative text-center">
    <h1 class="page-title animate-fade-in">Anesthesia Drug Calculator</h1>
    <p class="page-subtitle animate-fade-in-delayed">
      Calculate precise dosages with confidence
    </p>
  </div>
</div>

<div class="calculator-content">
  <div class="container-fluid px-4">
    <form action="" class="form" id="calcForm">
      <!-- Patient Information Card -->
      <div class="info-card animate-fade-in">
        <div class="row g-3">
          <div class="col-md-4">
            <div class="form-floating">
              <input
                type="number"
                name="age"
                id="age"
                class="form-control"
                value="{{ request.GET.age }}"
                placeholder="Age"
                required
              />
              <label for="age">Age (years)</label>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-floating">
              <input
                type="number"
                name="height"
                id="height"
                class="form-control"
                value="{{ request.GET.height }}"
                placeholder="Height"
                required
              />
              <label for="height">Height (cm)</label>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-floating">
              <input
                type="number"
                name="weight"
                id="weight"
                class="form-control"
                value="{{ request.GET.weight }}"
                placeholder="Weight"
                required
              />
              <label for="weight">Weight (kg)</label>
            </div>
          </div>
        </div>
      </div>

      <!-- Calculator Cards Grid -->
      <div class="calculator-grid">
        <!-- NEP Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-syringe"></i>
            </div>
            <h3>NEP Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="nep_conc"
                id="nep_conc"
                class="form-control"
                value="20"
                placeholder="Concentration"
              />
              <label for="nep_conc">NEP Concentration (mcg/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="nep_dr"
                id="nep_dr"
                class="form-control"
                value="0.01"
                placeholder="Dose Rate"
              />
              <label for="nep_dr">NEP Dose Rate (mcg/kg/min)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                nep_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  NEP c.i.(ml/hr):
                </div>
                <div class="result-value">{{ nep_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- EPI Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-heartbeat"></i>
            </div>
            <h3>EPI Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="epi_conc"
                id="epi_conc"
                class="form-control"
                value="20"
                placeholder="Concentration"
              />
              <label for="epi_conc">EPI Concentration (mcg/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="epi_dr"
                id="epi_dr"
                class="form-control"
                value="0.01"
                placeholder="Dose Rate"
              />
              <label for="epi_dr">EPI Dose Rate (mcg/kg/ml)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                epi_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  EPI c.i.(ml/hr)
                </div>
                <div class="result-value">{{ epi_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- DOPA Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-pills"></i>
            </div>
            <h3>DOPA Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="dopa_conc"
                id="dopa_conc"
                class="form-control"
                value="1"
                placeholder="Concentration"
              />
              <label for="dopa_conc">DOPA Concentration (mg/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="dopa_dr"
                id="dopa_dr"
                class="form-control"
                value="5"
                placeholder="Dose Rate"
              />
              <label for="dopa_dr">DOPA Dose Rate (mcg/kg/min)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                dopa_result
                !="test"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  DOPA c.i.(ml/hr)
                </div>
                <div class="result-value">{{ dopa_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- DOBU Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-pump-medical"></i>
            </div>
            <h3>DOBU Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="dobu_conc"
                id="dobu_conc"
                class="form-control"
                value="1"
                placeholder="Concentration"
              />
              <label for="dobu_conc">DOBU Concentration (mg/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="dobu_dr"
                id="dobu_dr"
                class="form-control"
                value="5"
                placeholder="Dose Rate"
              />
              <label for="dobu_dr">DOBU Dose Rate (mcg/kg/ml)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                dobu_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  DOBU c.i.(ml/hr)
                </div>
                <div class="result-value">{{ dobu_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- NTG Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-prescription-bottle"></i>
            </div>
            <h3>NTG Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="ntg_conc"
                id="ntg_conc"
                class="form-control"
                value="1"
                placeholder="Concentration"
              />
              <label for="ntg_conc">NTG Concentration (mg/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="ntg_dr"
                id="ntg_dr"
                class="form-control"
                value="0.5"
                placeholder="Dose Rate"
              />
              <label for="ntg_dr">NTG Dose Rate (mcg/kg/min)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                ntg_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  NTG c.i.(ml/hr)
                </div>
                <div class="result-value">{{ ntg_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- SNP Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-flask"></i>
            </div>
            <h3>SNP Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="snp_conc"
                id="snp_conc"
                class="form-control"
                value="1"
                placeholder="Concentration"
              />
              <label for="snp_conc">SNP Concentration (mg/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="snp_dr"
                id="snp_dr"
                class="form-control"
                value="0.5"
                placeholder="Dose Rate"
              />
              <label for="snp_dr">SNP Dose Rate (mcg/kg/ml)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                snp_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  SNP c.i.(ml/hr)
                </div>
                <div class="result-value">{{ snp_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- VASO Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>VASO Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="vaso_conc"
                id="vaso_conc"
                class="form-control"
                value="1"
                placeholder="Concentration"
              />
              <label for="vaso_conc">VASO Concentration (mg/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="vaso_dr1"
                id="vaso_dr1"
                class="form-control"
                value="0.04"
                placeholder="Dose Rate 1"
              />
              <label for="vaso_dr1">VASO Dose Rate (unit/min)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="vaso_dr2"
                id="vaso_dr2"
                class="form-control"
                value="0.04"
                placeholder="Dose Rate 2"
              />
              <label for="vaso_dr2">VASO Dose Rate (unit/kg/hr)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                vaso_result1
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  VASO c.i.(ml/hr) (unit/min)
                </div>
                <div class="result-value">{{ vaso_result1 }}</div>
              </div>
              <div
                {%
                if
                vaso_result2
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  VASO c.i.(ml/hr) (unit/kg/hr)
                </div>
                <div class="result-value">{{ vaso_result2 }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- PPF Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-capsules"></i>
            </div>
            <h3>PPF Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="ppf_conc"
                id="ppf_conc"
                class="form-control"
                value="20"
                placeholder="Concentration"
              />
              <label for="ppf_conc">PPF Concentration (mg/ml)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                ppf_result1
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  PPF c.i.(ml/hr) (MIN)
                </div>
                <div class="result-value">{{ ppf_result1 }}</div>
              </div>
              <div
                {%
                if
                ppf_result2
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  PPF c.i.(ml/hr) (MAX)
                </div>
                <div class="result-value">{{ ppf_result2 }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- RFTN Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-prescription"></i>
            </div>
            <h3>RFTN Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="rftn_conc"
                id="rftn_conc"
                class="form-control"
                value="20"
                placeholder="Concentration"
              />
              <label for="rftn_conc">RFTN Concentration (mcg/ml)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                rftn_result1
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  RFTN c.i.(ml/hr) (MIN)
                </div>
                <div class="result-value">{{ rftn_result1 }}</div>
              </div>
              <div
                {%
                if
                rftn_result2
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  RFTN c.i.(ml/hr) (MAX)
                </div>
                <div class="result-value">{{ rftn_result2 }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- SuFTN Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-tablets"></i>
            </div>
            <h3>SuFTN Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="suftn_conc"
                id="suftn_conc"
                class="form-control"
                value="5"
                placeholder="Concentration"
              />
              <label for="suftn_conc">SuFTN Concentration (mcg/ml)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                suftn_result1
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  SuFTN c.i.(ml/hr) (MIN)
                </div>
                <div class="result-value">{{ suftn_result1 }}</div>
              </div>
              <div
                {%
                if
                suftn_result2
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  SuFTN c.i.(ml/hr) (MAX)
                </div>
                <div class="result-value">{{ suftn_result2 }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- TXA Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-filter"></i>
            </div>
            <h3>TXA Calculation</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="txa_conc"
                id="txa_conc"
                class="form-control"
                value="100"
                placeholder="Concentration"
              />
              <label for="txa_conc">TXA Concentration (mg/ml)</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                txa_result1
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  TXA Loading (20min)
                </div>
                <div class="result-value">{{ txa_result1 }}</div>
              </div>
              <div
                {%
                if
                txa_result2
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  TXA c.i.(ml/hr)
                </div>
                <div class="result-value">{{ txa_result2 }}</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 기존 카드들: NEP, EPI, DOPA, ... (생략) -->
        <!-- ========================================= -->
        <!-- Calcium Gluconate Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Calcium Gluconate</h3>
          </div>
          <div class="calculator-card-body">
            <!-- 농도 -->
            <div class="form-floating">
              <input
                type="number"
                name="ca_conc"
                id="ca_conc"
                class="form-control"
                value="100"
                placeholder="Concentration (mg/ml)"
              />
              <label for="ca_conc">Calcium Gluconate Concentration (mg/ml)</label>
            </div>

            <!-- Bolus (g) -->
            <div class="form-floating">
              <input
                type="number"
                step="0.1"
                name="ca_bolus"
                id="ca_bolus"
                class="form-control"
                value="1.0"
                placeholder="Bolus Dose (g)"
              />
              <label for="ca_bolus">Bolus Dose (g) [1–2 g]</label>
            </div>

            <!-- Continuous Infusion (mg/kg/hr) -->
            <div class="form-floating">
              <input
                type="number"
                name="ca_dr"
                id="ca_dr"
                class="form-control"
                value="5"
                placeholder="Dose Rate (mg/kg/hr)"
              />
              <label for="ca_dr">Dose Rate (mg/kg/hr) [5–10]</label>
            </div>

            <!-- 결과 -->
            <div class="result-box">
              <!-- Bolus -->
              <div
                {%
                if
                ca_bolus_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Bolus (ml):
                </div>
                <div class="result-value">{{ ca_bolus_result }}</div>
              </div>
              <!-- Continuous Infusion -->
              <div
                {%
                if
                ca_cont_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  c.i.(ml/hr):
                </div>
                <div class="result-value">{{ ca_cont_result }}</div>
              </div>
            </div>
          </div>
        </div>



        <!-- Magnesium Sulfate Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Magnesium Sulfate</h3>
          </div>
          <div class="calculator-card-body">
            <!-- 농도 입력 -->
            <div class="form-floating">
              <input
                type="number"
                name="mg_conc"
                id="mg_conc"
                class="form-control"
                value="200"
                placeholder="Concentration"
              />
              <label for="mg_conc">Magnesium Sulfate Concentration (mg/ml)</label>
            </div>
            <!-- Bolus 용량 입력 (g) -->
            <div class="form-floating">
              <input
                type="number"
                step="0.1"
                name="mg_bolus"
                id="mg_bolus"
                class="form-control"
                value="1.0"
                placeholder="Bolus Dose (g)"
              />
              <label for="mg_bolus">Bolus Dose (g) [1–2 g, IV slow (30분 이상)]</label>
            </div>
            <!-- Continuous Infusion 용량 입력 (g/hr) -->
            <div class="form-floating">
              <input
                type="number"
                step="0.1"
                name="mg_infusion"
                id="mg_infusion"
                class="form-control"
                value="1.0"
                placeholder="Infusion Dose (g/hr)"
              />
              <label for="mg_infusion">Infusion Dose (g/hr) [1–2 g/hr]</label>
            </div>
            <!-- 결과 표시 영역 (TXA 등 다른 약들과 동일한 스타일) -->
            <div class="result-box">
              <!-- Bolus 결과 -->
              <div
                {%
                if mg_bolus_result != "Please fill all fields for bolus"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Bolus (ml):
                </div>
                <div class="result-value">{{ mg_bolus_result }}</div>
              </div>
              <!-- Continuous Infusion 결과 -->
              <div
                {%
                if mg_infusion_result != "Please fill all fields for continuous infusion"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  c.i.(ml/hr):
                </div>
                <div class="result-value">{{ mg_infusion_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sodium Bicarbonate (Bolus) Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Sodium Bicarbonate</h3>
          </div>
          <div class="calculator-card-body">
            <div class="form-floating">
              <input
                type="number"
                name="sbic_conc"
                id="sbic_conc"
                class="form-control"
                value="1"
                placeholder="Concentration"
              />
              <label for="sbic_conc">Sodium Bicarbonate Concentration (mEq/ml)</label>
            </div>
            <div class="form-floating">
              <input
                type="number"
                name="sbic_dr"
                id="sbic_dr"
                class="form-control"
                value="1"
                placeholder="Dose Rate"
              />
              <label for="sbic_dr">Sodium Bicarbonate Bolus (mEq/kg) [1 mEq/kg]</label>
            </div>
            <div class="result-box">
              <div
                {%
                if
                sbic_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Sodium Bicarbonate (Separate bolus, slowly, ml):
                </div>
                <div class="result-value">{{ sbic_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Phenylephrine Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Phenylephrine</h3>
          </div>
          <div class="calculator-card-body">
            <!-- 농도 입력 (기본 100 mcg/mL) -->
            <div class="form-floating">
              <input
                type="number"
                name="phen_conc"
                id="phen_conc"
                class="form-control"
                value="100"
                placeholder="Concentration (mcg/ml)"
              />
              <label for="phen_conc">Phenylephrine Concentration (mcg/ml)</label>
            </div>
            <!-- Bolus 용량 입력 (mcg) -->
            <div class="form-floating">
              <input
                type="number"
                name="phen_bolus"
                id="phen_bolus"
                class="form-control"
                value="50"
                placeholder="Bolus Dose (mcg)"
              />
              <label for="phen_bolus">Bolus Dose (mcg) [50–100 mcg IV push]</label>
            </div>
            <!-- Continuous infusion 용량 입력 (mcg/kg/min) -->
            <div class="form-floating">
              <input
                type="number"
                name="phen_dr"
                id="phen_dr"
                class="form-control"
                value="0.1"
                placeholder="Dose Rate (mcg/kg/min)"
              />
              <label for="phen_dr">Dose Rate (mcg/kg/min) [0.1–0.5]</label>
            </div>
            <!-- 결과 표시 영역 -->
            <div class="result-box">
              <!-- Bolus 결과 -->
              <div
                {%
                  if phen_bolus_result != "Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                  else
                %}class="result-item"
                {%
                  endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Bolus (ml):
                </div>
                <div class="result-value">{{ phen_bolus_result }}</div>
              </div>
              <!-- Continuous infusion 결과 -->
              <div
                {%
                  if phen_cont_result != "Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                  else
                %}class="result-item"
                {%
                  endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  c.i.(ml/hr):
                </div>
                <div class="result-value">{{ phen_cont_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Dantrolene Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Dantrolene</h3>
          </div>
          <div class="calculator-card-body">
            <!-- 농도 -->
            <div class="form-floating">
              <input
                type="number"
                name="dant_conc"
                id="dant_conc"
                class="form-control"
                value="20"
                placeholder="Concentration (mg/ml)"
              />
              <label for="dant_conc">Dantrolene Concentration (mg/ml)</label>
            </div>
            <p style="margin-top: 10px; font-size: 0.9em; color: #555;">
              Bolus: 2.5 mg/kg IV slow push. Repeat every 5–10 min up to a total of 10 mg/kg.
            </p>

            <!-- Continuous Infusion (mg/kg/hr) -->
            <div class="form-floating">
              <input
                type="number"
                step="0.01"
                name="dant_infusion"
                id="dant_infusion"
                class="form-control"
                value="0.25"
                placeholder="Infusion Dose (mg/kg/hr)"
              />
              <label for="dant_infusion">Continuous Infusion (mg/kg/hr) [0.25–0.5]</label>
            </div>

            <!-- 결과 -->
            <div class="result-box">
              <!-- 볼루스 (단회) -->
              <div
                {%
                if
                dant_bolus_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Bolus (mL) per dose:
                </div>
                <div class="result-value">{{ dant_bolus_result }}</div>
              </div>

              <!-- 최대 누적 -->
              <div
                {%
                if
                dant_max_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Maximum cumulative (mL):
                </div>
                <div class="result-value">{{ dant_max_result }}</div>
              </div>

              <!-- Continuous Infusion -->
              <div
                {%
                if
                dant_infusion_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Infusion Rate (mL/hr):
                </div>
                <div class="result-value">{{ dant_infusion_result }}</div>
              </div>
            </div>
          </div>
        </div>


        <!-- Lidocaine Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Lidocaine</h3>
          </div>
          <div class="calculator-card-body">
            <!-- 농도 입력 -->
            <div class="form-floating">
              <input
                type="number"
                name="lido_conc"
                id="lido_conc"
                class="form-control"
                value="20"
                placeholder="Concentration (mg/ml)"
              />
              <label for="lido_conc">2% Lidocaine Concentration (mg/ml)</label>
            </div>
            <!-- Bolus 용량 입력 (mg/kg) -->
            <div class="form-floating">
              <input
                type="number"
                name="lido_bolus"
                id="lido_bolus"
                class="form-control"
                value="1.0"
                placeholder="Bolus Dose (mg/kg)"
              />
              <label for="lido_bolus">Bolus Dose (mg/kg) [1–1.5 mg/kg over 2–3 min]</label>
            </div>
            <!-- Continuous infusion 용량 입력 (mg/min) -->
            <div class="form-floating">
              <input
                type="number"
                name="lido_infusion"
                id="lido_infusion"
                class="form-control"
                value="1"
                placeholder="Infusion Dose (mg/min)"
              />
              <label for="lido_infusion">Continuous Infusion (mg/min) [1–4 mg/min]</label>
            </div>
            <!-- 결과 표시 영역 -->
            <div class="result-box">
              <!-- Bolus 결과 -->
              <div
                {%
                  if lido_bolus_result != "Please fill all fields!!" and lido_bolus_result != "Please fill bolus fields!"
                %}class="result-item has-result"
                {%
                  else
                %}class="result-item"
                {%
                  endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Bolus (mL):
                </div>
                <div class="result-value">{{ lido_bolus_result }}</div>
              </div>
              <!-- Continuous infusion 결과 -->
              <div
                {%
                  if lido_infusion_result != "Please fill all fields!!" and lido_infusion_result != "Please fill infusion fields!"
                %}class="result-item has-result"
                {%
                  else
                %}class="result-item"
                {%
                  endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Infusion Rate (mL/hr):
                </div>
                <div class="result-value">{{ lido_infusion_result }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Atropine Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Atropine</h3>
          </div>
          <div class="calculator-card-body">
            <!-- 농도 -->
            <div class="form-floating">
              <input
                type="number"
                name="atropine_conc"
                id="atropine_conc"
                class="form-control"
                value="0.5"
                placeholder="Concentration (mg/ml)"
              />
              <label for="atropine_conc">Atropine Concentration (mg/ml)</label>
            </div>
            <!-- Bolus (mg) -->
            <div class="form-floating">
              <input
                type="number"
                step="0.1"
                name="atropine_bolus"
                id="atropine_bolus"
                class="form-control"
                value="0.5"
                placeholder="Bolus Dose (mg)"
              />
              <label for="atropine_bolus">Bolus Dose (mg) [0.5 mg per dose]</label>
            </div>
            <p style="margin-top: 10px; font-size: 0.9em; color: #555;">
              Bolus: 0.5 mg IV bolus. Repeat every 3–5 min up to a total of 3 mg.
            </p>

            <!-- 결과 -->
            <div class="result-box">
              <div
                {%
                if
                atropine_bolus_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Bolus (mL) per dose:
                </div>
                <div class="result-value">{{ atropine_bolus_result }}</div>
              </div>
              <div
                {%
                if
                atropine_max_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Maximum cumulative (mL):
                </div>
                <div class="result-value">{{ atropine_max_result }}</div>
              </div>
              <div
                {%
                if
                atropine_cont_result
                !="!!Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                else
                %}class="result-item"
                {%
                endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Continuous infusion:
                </div>
                <div class="result-value">{{ atropine_cont_result }}</div>
              </div>
            </div>
          </div>
        </div>


        <!-- Amiodarone Card -->
        <div class="calculator-card animate-fade-in">
          <div class="calculator-card-header">
            <div class="card-icon">
              <i class="fas fa-vial"></i>
            </div>
            <h3>Amiodarone</h3>
          </div>
          <div class="calculator-card-body">
            <!-- Bolus용 농도는 원액 그대로 50 mg/mL 사용 -->
            <div class="form-floating">
              <input
                type="number"
                name="amio_bolus"
                id="amio_bolus"
                class="form-control"
                value="5"
                placeholder="Bolus Dose (mg/kg)"
              />
              <label for="amio_bolus">Amiodarone Bolus Dose (mg/kg)</label>
            </div>
            <p style="margin-top: 10px; font-size: 0.9em; color: #555;">
              Bolus: 5 mg/kg IV bolus. (실제 임상에서는 300 mg 또는 150 mg씩 여러 번 투여)
            </p>
            <!-- Infusion용 농도는 희석 후 1.5 mg/mL 사용 -->
            <div class="form-floating">
              <input
                type="number"
                step="0.01"
                name="amio_infusion"
                id="amio_infusion"
                class="form-control"
                value="5"
                placeholder="Infusion Dose (mg/min)"
              />
              <label for="amio_infusion">Amiodarone Infusion Dose (mg/min) [예: 5 mg/min]</label>
            </div>
            <div class="result-box">
              <!-- Bolus 결과 -->
              <div
                {%
                  if amio_result_bolus != "Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                  else
                %}class="result-item"
                {%
                  endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Bolus (mL):
                </div>
                <div class="result-value">{{ amio_result_bolus }}</div>
              </div>
              <!-- Continuous Infusion 결과 -->
              <div
                {%
                  if amio_result_infusion != "Please fill all the fields!!"
                %}class="result-item has-result"
                {%
                  else
                %}class="result-item"
                {%
                  endif
                %}
              >
                <div class="result-label">
                  <i class="fas fa-calculator"></i>
                  Infusion (mL/hr):
                </div>
                <div class="result-value">{{ amio_result_infusion }}</div>
              </div>
            </div>
          </div>
        </div>
      <!-- End New Drugs Cards -->
      <!-- ======================================= -->
    </form>

    <button
      type="button"
      class="btn btn-calculate animate-fade-in"
      onclick="document.getElementById('calcForm').submit();"
    >
      Calculate
      <i class="fas fa-arrow-right"></i>
    </button>
  </div>
</div>
{% endblock %}

